<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta name="Content-Type" content="text/html; charset=utf-8" />
<title>Module: Ronin::Scanner::ClassMethods</title>
<link rel="stylesheet" href="../../css/style.css" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="../../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '../..';
  if (relpath != '') relpath += '/';
</script>
<script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>

  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="../../_index.html">Index (C)</a> &raquo; 
    <span class='title'><span class='object_link'><a href="../../Ronin.html" title="Ronin (module)">Ronin</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Scanner.html" title="Ronin::Scanner (module)">Scanner</a></span></span>
     &raquo; 
    <span class="title">ClassMethods</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  <a id="class_list_link" href="#">Class List</a>
  <a id="method_list_link" href="#">Method List</a>
  <a id ="file_list_link" href="#">File List</a>
</div>

      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Module: Ronin::Scanner::ClassMethods
  
  
  
</h1>

<dl class="box">
  
  
    
  
    
  
  
  
    <dt class="r1 last">Defined in:</dt>
    <dd class="r1 last">lib/ronin/scanner/class_methods.rb</dd>
  
</dl>
<div class="clear"></div>




  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#scanner-instance_method" title="#scanner (instance method)">- (Object) <strong>scanner</strong>(name) {|target, results, (options)| ... }</a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Defines a scanner in the category for the class.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#scanners-instance_method" title="#scanners (instance method)">- (Hash) <strong>scanners</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>The defined categories and their scanners for the class.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#scanners_in-instance_method" title="#scanners_in (instance method)">- (Array) <strong>scanners_in</strong>(name) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Collects all scanners in the specified category.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#scans_for-instance_method" title="#scans_for (instance method)">- (Set) <strong>scans_for</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Collects all categories that the class and ancestors scan
for.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#scans_for%3F-instance_method" title="#scans_for? (instance method)">- (Boolean) <strong>scans_for?</strong>(name) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Specifies whether or not there are scanners defined for the
specified category.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="scanner-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>scanner</strong>(name) {|target, results, (options)| ... }
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>Defines a scanner in the category for the class.</p>

<p>  scanner(:sqli) do |url,results,options|</p>

<pre class="code"><span class='comment'># ...
</span></pre>

<p>  end</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h3>Examples:</h3>
    
      <h4><div class='inline'><p>Defining a scanner for the <code>:lfi</code> category.</p>
</div></h4>
      <pre class="example code"><span class='id scanner'>scanner</span><span class='lparen'>(</span><span class='symbol'>:lfi</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id url'>url</span><span class='comma'>,</span><span class='id results'>results</span><span class='op'>|</span>
  <span class='comment'># ...
</span><span class='kw'>end</span></pre>
    
      <h4><div class='inline'><p>Defining a scanner for the <code>:sqli</code> category, that</p>
</div></h4>
      <pre class="example code">accepts additional scanner-options.</pre>
    
  </div>
<h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='type'>(<tt>Symbol</tt>, <tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
        <span class='name'>name</span>
      
      
      
        &mdash;
        <div class='inline'><p>The name of the category to define the scanner for.</p>
</div>
      
    </li>
  
</ul>
<h3>Yields:</h3>
<ul class="yield">
  
    <li>
      
        <span class='type'>(<tt>target</tt>, <tt>results</tt>, <tt>(options)</tt>)</span>
      
      
      
      
        &mdash;
        <div class='inline'><p>The block that will be called when the scanner is ran.</p>
</div>
      
    </li>
  
</ul>
<h3>Yield Parameters:</h3>
<ul class="yieldparam">
  
    <li>
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>)</span>
      
      
        <span class='name'>target</span>
      
      
      
        &mdash;
        <div class='inline'><p>The target object to scan.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='type'>(<tt>Proc</tt>)</span>
      
      
        <span class='name'>results</span>
      
      
      
        &mdash;
        <div class='inline'><p>A callback for enqueuing results from the scanner in
real-time.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <span class='name'>options</span>
      
      
      
        &mdash;
        <div class='inline'><p>Additional scanner-options that can be used to configure
the scanning.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ronin/scanner/class_methods.rb', line 145</span>

<span class='kw'>def</span> <span class='id scanner'>scanner</span><span class='lparen'>(</span><span class='id name'>name</span><span class='comma'>,</span><span class='op'>&amp;</span><span class='id block'>block</span><span class='rparen'>)</span>
  <span class='id method_name'>method_name</span> <span class='op'>=</span> <span class='id name'>name</span><span class='period'>.</span><span class='id to_s'>to_s</span><span class='period'>.</span><span class='id downcase'>downcase</span><span class='period'>.</span><span class='id gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>[\s\._-]+</span><span class='regexp_end'>/</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>_</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
  <span class='id name'>name</span> <span class='op'>=</span> <span class='id name'>name</span><span class='period'>.</span><span class='id to_sym'>to_sym</span>

  <span class='lparen'>(</span><span class='id scanners'>scanners</span><span class='lbracket'>[</span><span class='id name'>name</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='op'>&lt;&lt;</span> <span class='id block'>block</span>

  <span class='id define_method'>define_method</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>first_</span><span class='embexpr_beg'>#{</span><span class='id method_name'>method_name</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='op'>*</span><span class='id arguments'>arguments</span><span class='op'>|</span>
    <span class='id options'>options</span> <span class='op'>=</span> <span class='kw'>case</span> <span class='id arguments'>arguments</span><span class='period'>.</span><span class='id length'>length</span>
              <span class='kw'>when</span> <span class='int'>1</span>
                <span class='id arguments'>arguments</span><span class='period'>.</span><span class='id first'>first</span>
              <span class='kw'>when</span> <span class='int'>0</span>
                <span class='kw'>true</span>
              <span class='kw'>else</span>
                <span class='id raise'>raise</span><span class='lparen'>(</span><span class='const'>ArgumentError</span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>wrong number of arguments (</span><span class='embexpr_beg'>#{</span><span class='id arguments'>arguments</span><span class='period'>.</span><span class='id length'>length</span><span class='rbrace'>}</span><span class='tstring_content'> for 1)</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='id caller'>caller</span><span class='rparen'>)</span>
              <span class='kw'>end</span>

    <span class='id first_result'>first_result</span> <span class='op'>=</span> <span class='kw'>nil</span>

    <span class='id scan'>scan</span><span class='lparen'>(</span><span class='id name'>name</span> <span class='op'>=&gt;</span> <span class='id options'>options</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id category'>category</span><span class='comma'>,</span><span class='id result'>result</span><span class='op'>|</span>
      <span class='id first_result'>first_result</span> <span class='op'>=</span> <span class='id result'>result</span>
      <span class='kw'>break</span>
    <span class='kw'>end</span>

    <span class='kw'>return</span> <span class='id first_result'>first_result</span>
  <span class='kw'>end</span>

  <span class='id define_method'>define_method</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>has_</span><span class='embexpr_beg'>#{</span><span class='id method_name'>method_name</span><span class='rbrace'>}</span><span class='tstring_content'>?</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='op'>*</span><span class='id arguments'>arguments</span><span class='op'>|</span>
    <span class='op'>!</span><span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id send'>send</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>first_</span><span class='embexpr_beg'>#{</span><span class='id method_name'>method_name</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='op'>*</span><span class='id arguments'>arguments</span><span class='rparen'>)</span><span class='period'>.</span><span class='id nil?'>nil?</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id name'>name</span> <span class='op'>=</span> <span class='id name'>name</span><span class='period'>.</span><span class='id to_s'>to_s</span>

  <span class='id module_eval'>module_eval</span> <span class='tstring'><span class='tstring_beg'>%{</span><span class='tstring_content'>
</span><span class='tstring_content'>    def </span><span class='embexpr_beg'>#{</span><span class='id method_name'>method_name</span><span class='rbrace'>}</span><span class='tstring_content'>_scan(options=true,&amp;block)
</span><span class='tstring_content'>      results = scan(:</span><span class='embexpr_beg'>#{</span><span class='id name'>name</span><span class='period'>.</span><span class='id dump'>dump</span><span class='rbrace'>}</span><span class='tstring_content'> =&gt; options) do |category,result|
        block.call(result) if block
      end

</span><span class='tstring_content'>      return results[:</span><span class='embexpr_beg'>#{</span><span class='id name'>name</span><span class='period'>.</span><span class='id dump'>dump</span><span class='rbrace'>}</span><span class='tstring_content'>]
    end
</span><span class='tstring_content'>  </span><span class='tstring_end'>}</span></span>

  <span class='kw'>return</span> <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="scanners-instance_method">
  
    - (<tt>Hash</tt>) <strong>scanners</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>The defined categories and their scanners for the class.</p>


  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
      
        &mdash;
        <div class='inline'><p>The categories and the scanners defined for the them within
the class.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


36
37
38</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ronin/scanner/class_methods.rb', line 36</span>

<span class='kw'>def</span> <span class='id scanners'>scanners</span>
  <span class='ivar'>@scanners</span> <span class='op'>||=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="scanners_in-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Array.html" title="Array (class)">Array</a></span></tt>) <strong>scanners_in</strong>(name) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>Collects all scanners in the specified category.</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='type'>(<tt>Symbol</tt>, <tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
        <span class='name'>name</span>
      
      
      
        &mdash;
        <div class='inline'><p>The category name to return all scanners for.</p>
</div>
      
    </li>
  
</ul>
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Array.html" title="Array (class)">Array</a></span></tt>)</span>
      
      
      
      
        &mdash;
        <div class='inline'><p>All scanners in the specified category.</p>
</div>
      
    </li>
  
</ul>
<h3>Raises:</h3>
<ul class="raise">
  
    <li>
      
        <span class='type'>(<tt><span class='object_link'><a href="UnknownCategory.html" title="Ronin::Scanner::UnknownCategory (class)">UnknownCategory</a></span></tt>)</span>
      
      
      
      
        &mdash;
        <div class='inline'><p>No category has the specified name.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ronin/scanner/class_methods.rb', line 94</span>

<span class='kw'>def</span> <span class='id scanners_in'>scanners_in</span><span class='lparen'>(</span><span class='id name'>name</span><span class='rparen'>)</span>
  <span class='id name'>name</span> <span class='op'>=</span> <span class='id name'>name</span><span class='period'>.</span><span class='id to_sym'>to_sym</span>

  <span class='kw'>unless</span> <span class='id scans_for?'>scans_for?</span><span class='lparen'>(</span><span class='id name'>name</span><span class='rparen'>)</span>
    <span class='id raise'>raise</span><span class='lparen'>(</span><span class='const'>Ronin</span><span class='op'>::</span><span class='const'>Scanner</span><span class='op'>::</span><span class='const'>UnknownCategory</span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>unknown scanner category </span><span class='embexpr_beg'>#{</span><span class='id name'>name</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='id caller'>caller</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id tests'>tests</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

  <span class='id ancestors'>ancestors</span><span class='period'>.</span><span class='id each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id ancestor'>ancestor</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id ancestor'>ancestor</span><span class='period'>.</span><span class='id include?'>include?</span><span class='lparen'>(</span><span class='const'>Ronin</span><span class='op'>::</span><span class='const'>Scanner</span><span class='rparen'>)</span>
      <span class='kw'>if</span> <span class='id ancestor'>ancestor</span><span class='period'>.</span><span class='id scanners'>scanners</span><span class='period'>.</span><span class='id has_key?'>has_key?</span><span class='lparen'>(</span><span class='id name'>name</span><span class='rparen'>)</span>
        <span class='id tests'>tests</span> <span class='op'>+=</span> <span class='id ancestor'>ancestor</span><span class='period'>.</span><span class='id scanners'>scanners</span><span class='lbracket'>[</span><span class='id name'>name</span><span class='rbracket'>]</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='id tests'>tests</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="scans_for-instance_method">
  
    - (<tt>Set</tt>) <strong>scans_for</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>Collects all categories that the class and ancestors scan
for.</p>


  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Set</tt>)</span>
      
      
      
      
        &mdash;
        <div class='inline'><p>The category names of all defined scanners.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


47
48
49
50
51
52
53
54
55
56
57</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ronin/scanner/class_methods.rb', line 47</span>

<span class='kw'>def</span> <span class='id scans_for'>scans_for</span>
  <span class='id names'>names</span> <span class='op'>=</span> <span class='const'>Set</span><span class='lbracket'>[</span><span class='rbracket'>]</span>

  <span class='id ancestors'>ancestors</span><span class='period'>.</span><span class='id each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id ancestor'>ancestor</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id ancestor'>ancestor</span><span class='period'>.</span><span class='id include?'>include?</span><span class='lparen'>(</span><span class='const'>Ronin</span><span class='op'>::</span><span class='const'>Scanner</span><span class='rparen'>)</span>
      <span class='id names'>names</span> <span class='op'>+=</span> <span class='id ancestor'>ancestor</span><span class='period'>.</span><span class='id scanners'>scanners</span><span class='period'>.</span><span class='id keys'>keys</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='id names'>names</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="scans_for?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>scans_for?</strong>(name) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>Specifies whether or not there are scanners defined for the
specified category.</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='type'>(<tt>Symbol</tt>, <tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
        <span class='name'>name</span>
      
      
      
        &mdash;
        <div class='inline'><p>The name of the category to search for scanners within.</p>
</div>
      
    </li>
  
</ul>
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
      
        &mdash;
        <div class='inline'><p>Specifies whether there is a scanner defined for the
specified category.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


70
71
72
73
74
75
76
77
78
79
80</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ronin/scanner/class_methods.rb', line 70</span>

<span class='kw'>def</span> <span class='id scans_for?'>scans_for?</span><span class='lparen'>(</span><span class='id name'>name</span><span class='rparen'>)</span>
  <span class='id name'>name</span> <span class='op'>=</span> <span class='id name'>name</span><span class='period'>.</span><span class='id to_sym'>to_sym</span>

  <span class='id ancestors'>ancestors</span><span class='period'>.</span><span class='id each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id ancestor'>ancestor</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id ancestor'>ancestor</span><span class='period'>.</span><span class='id include?'>include?</span><span class='lparen'>(</span><span class='const'>Ronin</span><span class='op'>::</span><span class='const'>Scanner</span><span class='rparen'>)</span>
      <span class='kw'>return</span> <span class='kw'>true</span> <span class='kw'>if</span> <span class='id ancestor'>ancestor</span><span class='period'>.</span><span class='id scanners'>scanners</span><span class='period'>.</span><span class='id has_key?'>has_key?</span><span class='lparen'>(</span><span class='id name'>name</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='kw'>false</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    <div id="footer">
  Generated on Wed Sep  1 02:22:03 2010 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.6.0 (ruby-1.9.2).
</div>

  </body>
</html>